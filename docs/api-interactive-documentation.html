<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAMS API Documentation - Interactive Explorer</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css" />
    <link rel="icon" type="image/x-icon" href="./favicon.ico" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            margin: 0;
            background: #fafafa;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        
        /* Custom SAMS styling */
        .sams-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .sams-header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .sams-header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .search-container {
            position: sticky;
            top: 0;
            background: white;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .search-input {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            display: block;
            padding: 12px 20px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .search-results {
            background: white;
            margin: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }
        
        .search-result-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .search-result-item:hover {
            background: #f8f9fa;
        }
        
        .search-result-item:last-child {
            border-bottom: none;
        }
        
        .result-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        
        .result-method {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 10px;
        }
        
        .method-get { background: #61affe; color: white; }
        .method-post { background: #49cc90; color: white; }
        .method-put { background: #fca130; color: white; }
        .method-delete { background: #f93e3e; color: white; }
        .method-patch { background: #50e3c2; color: white; }
        
        .result-description {
            color: #666;
            font-size: 14px;
            margin-top: 8px;
        }
        
        .swagger-ui {
            max-width: none;
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body {
                background: #1a1a1a;
                color: #ffffff;
            }
            
            .sams-header {
                background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            }
            
            .search-container {
                background: #2d2d2d;
            }
            
            .search-input {
                background: #3a3a3a;
                color: white;
                border-color: #4a4a4a;
            }
            
            .search-results {
                background: #2d2d2d;
            }
            
            .search-result-item {
                border-bottom-color: #404040;
            }
            
            .search-result-item:hover {
                background: #3a3a3a;
            }
            
            .result-title {
                color: #ffffff;
            }
            
            .result-description {
                color: #a0a0a0;
            }
        }
    </style>
</head>
<body>
    <div class="sams-header">
        <h1>🚀 SAMS API Documentation</h1>
        <p>Interactive API Explorer & Documentation Hub</p>
    </div>
    
    <div class="search-container">
        <input 
            type="text" 
            class="search-input" 
            placeholder="🔍 Search API endpoints, methods, or descriptions..."
            id="api-search"
        />
    </div>
    
    <div class="search-results" id="search-results"></div>
    
    <div id="swagger-ui"></div>
    
    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
    
    <script>
        // SAMS API Specification
        const samsApiSpec = {
            "openapi": "3.0.3",
            "info": {
                "title": "SAMS API",
                "description": "Security and Monitoring System (SAMS) - Comprehensive API for enterprise monitoring, alerting, and security management",
                "version": "2.0.0",
                "contact": {
                    "name": "SAMS API Support",
                    "email": "api-support@sams.enterprise.com"
                },
                "license": {
                    "name": "MIT",
                    "url": "https://opensource.org/licenses/MIT"
                }
            },
            "servers": [
                {
                    "url": "https://api.sams.enterprise.com/v2",
                    "description": "Production Server"
                },
                {
                    "url": "https://staging-api.sams.enterprise.com/v2",
                    "description": "Staging Server"
                },
                {
                    "url": "http://localhost:8080/v2",
                    "description": "Development Server"
                }
            ],
            "security": [
                {
                    "bearerAuth": []
                }
            ],
            "tags": [
                {
                    "name": "Authentication",
                    "description": "User authentication and token management"
                },
                {
                    "name": "Servers",
                    "description": "Server monitoring and management"
                },
                {
                    "name": "Alerts",
                    "description": "Alert management and configuration"
                },
                {
                    "name": "Metrics",
                    "description": "System metrics and performance data"
                },
                {
                    "name": "Users",
                    "description": "User management and permissions"
                },
                {
                    "name": "Dashboards",
                    "description": "Custom dashboard management"
                },
                {
                    "name": "Reports",
                    "description": "Report generation and analytics"
                },
                {
                    "name": "Security",
                    "description": "Security scanning and vulnerability management"
                },
                {
                    "name": "Backups",
                    "description": "Backup and recovery operations"
                },
                {
                    "name": "Voice Commands",
                    "description": "Voice command integration and settings"
                }
            ],
            "paths": {
                "/auth/login": {
                    "post": {
                        "tags": ["Authentication"],
                        "summary": "User Login",
                        "description": "Authenticate user and receive JWT token",
                        "operationId": "loginUser",
                        "requestBody": {
                            "required": true,
                            "content": {
                                "application/json": {
                                    "schema": {
                                        "type": "object",
                                        "required": ["username", "password"],
                                        "properties": {
                                            "username": {
                                                "type": "string",
                                                "example": "admin"
                                            },
                                            "password": {
                                                "type": "string",
                                                "format": "password",
                                                "example": "password123"
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "responses": {
                            "200": {
                                "description": "Login successful",
                                "content": {
                                    "application/json": {
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "success": {"type": "boolean", "example": true},
                                                "message": {"type": "string", "example": "Login successful"},
                                                "data": {
                                                    "type": "object",
                                                    "properties": {
                                                        "token": {"type": "string"},
                                                        "username": {"type": "string"},
                                                        "tokenType": {"type": "string", "example": "Bearer"}
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "401": {
                                "description": "Invalid credentials"
                            }
                        }
                    }
                },
                "/auth/logout": {
                    "post": {
                        "tags": ["Authentication"],
                        "summary": "User Logout",
                        "description": "Revoke JWT token and logout user",
                        "operationId": "logoutUser",
                        "security": [{"bearerAuth": []}],
                        "responses": {
                            "200": {
                                "description": "Logout successful"
                            }
                        }
                    }
                },
                "/servers": {
                    "get": {
                        "tags": ["Servers"],
                        "summary": "List All Servers",
                        "description": "Retrieve list of all monitored servers",
                        "operationId": "listServers",
                        "parameters": [
                            {
                                "name": "status",
                                "in": "query",
                                "description": "Filter by server status",
                                "schema": {
                                    "type": "string",
                                    "enum": ["online", "offline", "warning", "critical"]
                                }
                            },
                            {
                                "name": "limit",
                                "in": "query",
                                "description": "Number of results per page",
                                "schema": {
                                    "type": "integer",
                                    "default": 50,
                                    "minimum": 1,
                                    "maximum": 100
                                }
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "List of servers",
                                "content": {
                                    "application/json": {
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "success": {"type": "boolean"},
                                                "data": {
                                                    "type": "array",
                                                    "items": {"$ref": "#/components/schemas/Server"}
                                                },
                                                "pagination": {"$ref": "#/components/schemas/Pagination"}
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "post": {
                        "tags": ["Servers"],
                        "summary": "Add New Server",
                        "description": "Register a new server for monitoring",
                        "operationId": "addServer",
                        "requestBody": {
                            "required": true,
                            "content": {
                                "application/json": {
                                    "schema": {"$ref": "#/components/schemas/ServerCreate"}
                                }
                            }
                        },
                        "responses": {
                            "201": {
                                "description": "Server created successfully"
                            }
                        }
                    }
                },
                "/servers/{id}": {
                    "get": {
                        "tags": ["Servers"],
                        "summary": "Get Server Details",
                        "description": "Retrieve detailed information about a specific server",
                        "operationId": "getServer",
                        "parameters": [
                            {
                                "name": "id",
                                "in": "path",
                                "required": true,
                                "description": "Server ID",
                                "schema": {"type": "integer"}
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "Server details",
                                "content": {
                                    "application/json": {
                                        "schema": {"$ref": "#/components/schemas/Server"}
                                    }
                                }
                            }
                        }
                    }
                },
                "/alerts": {
                    "get": {
                        "tags": ["Alerts"],
                        "summary": "List Alerts",
                        "description": "Retrieve system alerts with filtering options",
                        "operationId": "listAlerts",
                        "parameters": [
                            {
                                "name": "severity",
                                "in": "query",
                                "description": "Filter by alert severity",
                                "schema": {
                                    "type": "string",
                                    "enum": ["low", "medium", "high", "critical"]
                                }
                            },
                            {
                                "name": "status",
                                "in": "query",
                                "description": "Filter by alert status",
                                "schema": {
                                    "type": "string",
                                    "enum": ["active", "acknowledged", "resolved"]
                                }
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "List of alerts"
                            }
                        }
                    }
                },
                "/alerts/thresholds": {
                    "get": {
                        "tags": ["Alerts"],
                        "summary": "List Alert Thresholds",
                        "description": "Get all configured alert thresholds",
                        "operationId": "listThresholds",
                        "responses": {
                            "200": {
                                "description": "Alert thresholds configuration"
                            }
                        }
                    },
                    "post": {
                        "tags": ["Alerts"],
                        "summary": "Create Alert Threshold",
                        "description": "Configure custom alert threshold for metrics",
                        "operationId": "createThreshold",
                        "requestBody": {
                            "required": true,
                            "content": {
                                "application/json": {
                                    "schema": {"$ref": "#/components/schemas/ThresholdConfig"}
                                }
                            }
                        },
                        "responses": {
                            "201": {
                                "description": "Threshold created successfully"
                            }
                        }
                    }
                },
                "/metrics/{serverName}": {
                    "get": {
                        "tags": ["Metrics"],
                        "summary": "Get Server Metrics",
                        "description": "Retrieve real-time metrics for a specific server",
                        "operationId": "getServerMetrics",
                        "parameters": [
                            {
                                "name": "serverName",
                                "in": "path",
                                "required": true,
                                "description": "Server name",
                                "schema": {"type": "string"}
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "Server metrics data"
                            }
                        }
                    }
                },
                "/voice/commands": {
                    "get": {
                        "tags": ["Voice Commands"],
                        "summary": "List Voice Commands",
                        "description": "Get available voice commands and their descriptions",
                        "operationId": "listVoiceCommands",
                        "responses": {
                            "200": {
                                "description": "Available voice commands"
                            }
                        }
                    }
                },
                "/voice/settings": {
                    "get": {
                        "tags": ["Voice Commands"],
                        "summary": "Get Voice Settings",
                        "description": "Retrieve current voice command settings",
                        "operationId": "getVoiceSettings",
                        "responses": {
                            "200": {
                                "description": "Voice settings configuration"
                            }
                        }
                    },
                    "put": {
                        "tags": ["Voice Commands"],
                        "summary": "Update Voice Settings",
                        "description": "Update voice command configuration",
                        "operationId": "updateVoiceSettings",
                        "requestBody": {
                            "required": true,
                            "content": {
                                "application/json": {
                                    "schema": {"$ref": "#/components/schemas/VoiceSettings"}
                                }
                            }
                        },
                        "responses": {
                            "200": {
                                "description": "Settings updated successfully"
                            }
                        }
                    }
                }
            },
            "components": {
                "securitySchemes": {
                    "bearerAuth": {
                        "type": "http",
                        "scheme": "bearer",
                        "bearerFormat": "JWT"
                    }
                },
                "schemas": {
                    "Server": {
                        "type": "object",
                        "properties": {
                            "id": {"type": "integer"},
                            "name": {"type": "string"},
                            "hostname": {"type": "string"},
                            "ip_address": {"type": "string"},
                            "status": {"type": "string", "enum": ["online", "offline", "warning", "critical"]},
                            "last_seen": {"type": "string", "format": "date-time"},
                            "metrics": {"$ref": "#/components/schemas/ServerMetrics"}
                        }
                    },
                    "ServerCreate": {
                        "type": "object",
                        "required": ["name", "hostname", "ip_address"],
                        "properties": {
                            "name": {"type": "string"},
                            "hostname": {"type": "string"},
                            "ip_address": {"type": "string"}
                        }
                    },
                    "ServerMetrics": {
                        "type": "object",
                        "properties": {
                            "cpu_usage": {"type": "number", "format": "float"},
                            "memory_usage": {"type": "number", "format": "float"},
                            "disk_usage": {"type": "number", "format": "float"},
                            "network_io": {"type": "object"},
                            "uptime": {"type": "integer"}
                        }
                    },
                    "ThresholdConfig": {
                        "type": "object",
                        "required": ["metric_name", "warning_threshold", "critical_threshold"],
                        "properties": {
                            "metric_name": {"type": "string"},
                            "warning_threshold": {"type": "number"},
                            "critical_threshold": {"type": "number"},
                            "comparison_operator": {"type": "string", "enum": [">", "<", ">=", "<=", "==", "!="]},
                            "enabled": {"type": "boolean", "default": true}
                        }
                    },
                    "VoiceSettings": {
                        "type": "object",
                        "properties": {
                            "enabled": {"type": "boolean"},
                            "continuous_listening": {"type": "boolean"},
                            "confirmation_enabled": {"type": "boolean"},
                            "language": {"type": "string", "default": "en-US"},
                            "confidence_threshold": {"type": "number", "default": 0.8}
                        }
                    },
                    "Pagination": {
                        "type": "object",
                        "properties": {
                            "page": {"type": "integer"},
                            "per_page": {"type": "integer"},
                            "total": {"type": "integer"},
                            "pages": {"type": "integer"}
                        }
                    }
                }
            }
        };
        
        // Initialize Swagger UI
        const ui = SwaggerUIBundle({
            spec: samsApiSpec,
            dom_id: '#swagger-ui',
            deepLinking: true,
            presets: [
                SwaggerUIBundle.presets.apis,
                SwaggerUIStandalonePreset.slice(1) // remove top bar plugin
            ],
            plugins: [
                SwaggerUIBundle.plugins.DownloadUrl
            ],
            layout: "StandaloneLayout",
            validatorUrl: null,
            tryItOutEnabled: true,
            requestInterceptor: (request) => {
                // Add custom headers or modify requests
                request.headers['X-API-Client'] = 'SAMS-Interactive-Docs';
                return request;
            },
            responseInterceptor: (response) => {
                // Handle responses
                return response;
            }
        });
        
        // Search functionality
        class APISearchEngine {
            constructor(apiSpec) {
                this.apiSpec = apiSpec;
                this.searchIndex = this.buildSearchIndex();
            }
            
            buildSearchIndex() {
                const index = [];
                
                // Index all paths
                Object.entries(this.apiSpec.paths).forEach(([path, methods]) => {
                    Object.entries(methods).forEach(([method, details]) => {
                        index.push({
                            path: path,
                            method: method.toUpperCase(),
                            summary: details.summary || '',
                            description: details.description || '',
                            tags: details.tags || [],
                            operationId: details.operationId || '',
                            searchText: `${path} ${method} ${details.summary || ''} ${details.description || ''} ${(details.tags || []).join(' ')}`
                        });
                    });
                });
                
                return index;
            }
            
            search(query) {
                if (!query || query.length < 2) return [];
                
                const lowerQuery = query.toLowerCase();
                const results = this.searchIndex.filter(item => {
                    return item.searchText.toLowerCase().includes(lowerQuery);
                });
                
                // Sort by relevance
                return results.sort((a, b) => {
                    const aScore = this.calculateRelevanceScore(a, lowerQuery);
                    const bScore = this.calculateRelevanceScore(b, lowerQuery);
                    return bScore - aScore;
                });
            }
            
            calculateRelevanceScore(item, query) {
                let score = 0;
                const text = item.searchText.toLowerCase();
                
                // Exact matches in summary get highest score
                if (item.summary.toLowerCase().includes(query)) score += 10;
                
                // Path matches get high score
                if (item.path.toLowerCase().includes(query)) score += 8;
                
                // Method matches get medium score
                if (item.method.toLowerCase().includes(query)) score += 5;
                
                // Description matches get lower score
                if (item.description.toLowerCase().includes(query)) score += 3;
                
                // Tag matches get lowest score
                if (item.tags.some(tag => tag.toLowerCase().includes(query))) score += 2;
                
                return score;
            }
        }
        
        const searchEngine = new APISearchEngine(samsApiSpec);
        const searchInput = document.getElementById('api-search');
        const searchResults = document.getElementById('search-results');
        
        let searchTimeout;
        
        searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                performSearch(e.target.value);
            }, 300);
        });
        
        function performSearch(query) {
            if (!query || query.length < 2) {
                searchResults.style.display = 'none';
                return;
            }
            
            const results = searchEngine.search(query);
            displaySearchResults(results);
        }
        
        function displaySearchResults(results) {
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-result-item"><div class="result-title">No results found</div></div>';
                searchResults.style.display = 'block';
                return;
            }
            
            const html = results.slice(0, 10).map(result => `
                <div class="search-result-item" onclick="navigateToEndpoint('${result.operationId}')">
                    <div class="result-title">
                        <span class="result-method method-${result.method.toLowerCase()}">${result.method}</span>
                        ${result.path}
                    </div>
                    <div class="result-description">
                        ${result.summary}${result.description ? ' - ' + result.description : ''}
                    </div>
                </div>
            `).join('');
            
            searchResults.innerHTML = html;
            searchResults.style.display = 'block';
        }
        
        function navigateToEndpoint(operationId) {
            // Hide search results
            searchResults.style.display = 'none';
            searchInput.value = '';
            
            // Find and expand the operation
            const operation = document.querySelector(`[data-operation-id="${operationId}"]`);
            if (operation) {
                operation.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Try to expand if collapsed
                const toggleButton = operation.querySelector('.opblock-summary-control');
                if (toggleButton && !operation.classList.contains('is-open')) {
                    setTimeout(() => toggleButton.click(), 500);
                }
            } else {
                // Fallback: scroll to the section
                setTimeout(() => {
                    const elements = document.querySelectorAll('.opblock-summary-description, .opblock-summary-path');
                    for (let element of elements) {
                        if (element.textContent.includes(operationId)) {
                            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            break;
                        }
                    }
                }, 1000);
            }
        }
        
        // Hide search results when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-container') && !e.target.closest('.search-results')) {
                searchResults.style.display = 'none';
            }
        });
        
        // Keyboard navigation
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                searchResults.style.display = 'none';
                searchInput.blur();
            }
        });
        
        window.ui = ui;
    </script>
</body>
</html>
